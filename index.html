<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ENTROPY — Martin Tomek VR</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.0/dist/aframe-extras.min.js"></script>
    <style>
        .a-enter-vr-button {
            background: linear-gradient(135deg, #f5576c 0%, #ff0844 100%) !important;
            border-radius: 12px !important;
            font-weight: 600 !important;
            padding: 14px 28px !important;
            font-size: 16px !important;
        }
        #splash {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 99999; display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            background: #000; font-family: 'Courier New', monospace;
            color: #fff; cursor: pointer; touch-action: manipulation;
            overflow: hidden;
        }
        #splash.hidden { display: none; }
        #splash .title {
            font-size: 48px; font-weight: 900; letter-spacing: 12px;
            background: linear-gradient(135deg, #f5576c, #667eea, #43e97b);
            -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; color: transparent;
            animation: glitchTitle 3s infinite;
        }
        #splash .sub {
            font-size: 12px; letter-spacing: 4px; color: #555;
            margin: 16px 0 40px; text-transform: uppercase;
        }
        #splash .enter-btn {
            font-family: 'Courier New', monospace; font-size: 20px;
            font-weight: 700; letter-spacing: 6px; color: #000;
            background: #f5576c; border: none; padding: 20px 60px;
            cursor: pointer; text-transform: uppercase;
            transition: all 0.3s; position: relative; overflow: hidden;
        }
        #splash .enter-btn:hover { background: #667eea; transform: scale(1.05); }
        #splash .enter-btn:active { transform: scale(0.95); }
        #splash .credit {
            position: absolute; bottom: 20px; font-size: 10px;
            color: #333; letter-spacing: 2px;
        }
        #splash .scanline {
            position: absolute; top: 0; left: 0; width: 100%; height: 2px;
            background: rgba(245, 87, 108, 0.3);
            animation: scanDown 4s linear infinite;
        }
        @keyframes scanDown {
            0% { top: -2px; } 100% { top: 100%; }
        }
        @keyframes glitchTitle {
            0%, 90%, 100% { transform: translate(0); }
            92% { transform: translate(-4px, 2px); }
            94% { transform: translate(4px, -2px); }
            96% { transform: translate(-2px, -1px); }
            98% { transform: translate(2px, 1px); }
        }
        #diag {
            margin-top: 24px; font-size: 11px; color: #444;
            max-width: 400px; text-align: left; line-height: 1.5;
        }
        #diag .ok { color: #43e97b; }
        #diag .err { color: #f5576c; }
        #diag .info { color: #667eea; }
    </style>
</head>
<body>

<!-- SPLASH SCREEN -->
<div id="splash">
    <div class="scanline"></div>
    <div class="title">ENTROPY</div>
    <div class="sub">A corrupted gallery by Martin Tomek</div>
    <button class="enter-btn" id="enter-btn">ENTER VOID</button>
    <div id="diag"></div>
    <div class="credit">WEBXR / QUEST 2 / A-FRAME</div>
</div>

<script>
    /* ═══════════════════════════════════════════
       AUDIO ENGINE
       ═══════════════════════════════════════════ */
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playGlitchSound(freq, dur, type) {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.type = type || 'sawtooth';
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(freq * 0.1, audioCtx.currentTime + dur);
        gain.gain.setValueAtTime(0.08, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + dur);
        osc.start(audioCtx.currentTime);
        osc.stop(audioCtx.currentTime + dur);
    }

    function playDrone(freq) {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        const lfo = audioCtx.createOscillator();
        const lfoGain = audioCtx.createGain();
        lfo.frequency.value = 0.3;
        lfoGain.gain.value = 10;
        lfo.connect(lfoGain); lfoGain.connect(osc.frequency);
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.type = 'sine';
        osc.frequency.value = freq;
        gain.gain.value = 0.03;
        lfo.start(); osc.start();
        return { osc, gain, lfo };
    }

    /* ═══════════════════════════════════════════
       SPLASH / ENTER VR
       ═══════════════════════════════════════════ */
    (function() {
        const splash = document.getElementById('splash');
        const btn = document.getElementById('enter-btn');
        const diag = document.getElementById('diag');

        function log(msg, cls) {
            const d = document.createElement('div');
            d.className = cls || '';
            d.textContent = '> ' + msg;
            diag.appendChild(d);
        }

        const ua = navigator.userAgent;
        const isQuest = /Quest/i.test(ua) || /OculusBrowser/i.test(ua);
        log('Quest: ' + (isQuest ? 'YES' : 'no (desktop)'), isQuest ? 'ok' : 'info');
        log('HTTPS: ' + (location.protocol === 'https:'), location.protocol === 'https:' ? 'ok' : 'err');

        if (navigator.xr) {
            log('WebXR: available', 'ok');
            navigator.xr.isSessionSupported('immersive-vr').then(s => {
                log('immersive-vr: ' + s, s ? 'ok' : 'err');
                if (!s) log('Switch Quest Browser to Mobile mode!', 'err');
            }).catch(e => log('XR error: ' + e.message, 'err'));
        } else {
            log('WebXR: not available', 'err');
        }

        btn.addEventListener('click', async () => {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const scene = document.querySelector('a-scene');
            if (!scene) return;
            if (!scene.hasLoaded) {
                log('Loading scene...', 'info');
                await new Promise(r => scene.addEventListener('loaded', r, { once: true }));
            }
            try {
                await scene.enterVR();
                splash.classList.add('hidden');
            } catch(e) {
                log('VR failed: ' + e.message, 'err');
                splash.classList.add('hidden');
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            const scene = document.querySelector('a-scene');
            if (scene) {
                scene.addEventListener('enter-vr', () => splash.classList.add('hidden'));
                scene.addEventListener('exit-vr', () => splash.classList.remove('hidden'));
            }
        });
    })();


    /* ═══════════════════════════════════════════
       A-FRAME COMPONENTS
       ═══════════════════════════════════════════ */

    // ── Global corruption state ──
    AFRAME.registerSystem('corruption', {
        init: function() {
            this.level = 0;          // 0.0 to 1.0
            this.maxLevel = 1.0;
        },
        add: function(amount) {
            this.level = Math.min(this.maxLevel, this.level + amount);
            this.el.emit('corruption-changed', { level: this.level });
        },
        getLevel: function() { return this.level; }
    });

    // ── Quest 2 locomotion ──
    AFRAME.registerComponent('quest-locomotion', {
        schema: { speed: { default: 3 }, snapAngle: { default: 45 } },
        init: function() {
            this.moveVec = new THREE.Vector3();
            this.snapReady = true;
            this.leftStick = { x: 0, y: 0 };
            this.rightStick = { x: 0, y: 0 };
            this.controllersBound = false;

            // Scene-level fallback: catch ALL axismove events that bubble up
            this.el.sceneEl.addEventListener('axismove', (e) => {
                const target = e.target;
                const id = target.id;
                const ax = e.detail.axis;
                // Determine hand from element id or laser-controls attribute
                let hand = null;
                if (id === 'left-ctrl') hand = 'left';
                else if (id === 'right-ctrl') hand = 'right';
                else {
                    const lc = target.getAttribute('laser-controls');
                    if (lc) hand = (typeof lc === 'object') ? lc.hand : (lc.includes('left') ? 'left' : 'right');
                }
                if (!hand) return;
                // Try indices [2,3] first (old WebVR), then [0,1] (WebXR)
                let x = 0, y = 0;
                if (ax.length >= 4 && (Math.abs(ax[2]) > 0.01 || Math.abs(ax[3]) > 0.01)) {
                    x = ax[2]; y = ax[3];
                } else if (ax.length >= 2) {
                    x = ax[0]; y = ax[1];
                }
                if (hand === 'left') { this.leftStick.x = x; this.leftStick.y = y; }
                else { this.rightStick.x = x; this.rightStick.y = y; }
            });
        },
        bindControllers: function() {
            if (this.controllersBound) return;
            const left = document.getElementById('left-ctrl');
            const right = document.getElementById('right-ctrl');

            if (left) {
                // thumbstickmoved is the reliable A-Frame event for Oculus Touch
                left.addEventListener('thumbstickmoved', (e) => {
                    this.leftStick.x = e.detail.x;
                    this.leftStick.y = e.detail.y;
                });
            }
            if (right) {
                right.addEventListener('thumbstickmoved', (e) => {
                    this.rightStick.x = e.detail.x;
                    this.rightStick.y = e.detail.y;
                });
            }
            if (left || right) {
                this.controllersBound = true;
                console.log('[quest-locomotion] Controllers bound. L:', !!left, 'R:', !!right);
            }
        },
        tick: function(t, dt) {
            if (!dt) return;

            // Keep trying to bind until controllers appear
            if (!this.controllersBound) this.bindControllers();

            const cam = this.el.querySelector('[camera]');
            if (!cam) return;
            const sec = dt / 1000;

            // Movement from left stick
            if (Math.abs(this.leftStick.x) > 0.1 || Math.abs(this.leftStick.y) > 0.1) {
                const camObj = cam.object3D;
                const dir = new THREE.Vector3(0, 0, -1);
                dir.applyQuaternion(camObj.quaternion);
                dir.y = 0; dir.normalize();
                const right = new THREE.Vector3(1, 0, 0);
                right.applyQuaternion(camObj.quaternion);
                right.y = 0; right.normalize();

                this.moveVec.set(0, 0, 0);
                this.moveVec.addScaledVector(right, this.leftStick.x * this.data.speed * sec);
                this.moveVec.addScaledVector(dir, -this.leftStick.y * this.data.speed * sec);
                this.el.object3D.position.add(this.moveVec);
            }

            // Snap turn from right stick
            if (Math.abs(this.rightStick.x) > 0.6) {
                if (this.snapReady) {
                    const angle = this.rightStick.x > 0 ? -this.data.snapAngle : this.data.snapAngle;
                    this.el.object3D.rotation.y += THREE.MathUtils.degToRad(angle);
                    this.snapReady = false;
                    playGlitchSound(200 + Math.random() * 400, 0.1, 'square');
                }
            } else {
                this.snapReady = true;
            }

        }
    });

    // ── Float animation ──
    AFRAME.registerComponent('float', {
        schema: {
            amplitude: { default: 0.3 },
            speed: { default: 1 },
            phase: { default: 0 }
        },
        init: function() {
            this.startY = this.el.object3D.position.y;
        },
        tick: function(t) {
            const d = this.data;
            this.el.object3D.position.y = this.startY +
                Math.sin((t / 1000) * d.speed + d.phase) * d.amplitude;
        }
    });

    // ── Slow rotation ──
    AFRAME.registerComponent('spin', {
        schema: {
            x: { default: 0 }, y: { default: 0.2 }, z: { default: 0 }
        },
        tick: function(t, dt) {
            if (!dt) return;
            const s = dt / 1000;
            this.el.object3D.rotation.x += this.data.x * s;
            this.el.object3D.rotation.y += this.data.y * s;
            this.el.object3D.rotation.z += this.data.z * s;
        }
    });

    // ── Orbit around a point ──
    AFRAME.registerComponent('orbit', {
        schema: {
            radius: { default: 5 },
            speed: { default: 0.3 },
            phase: { default: 0 },
            tilt: { default: 0 },
            yOffset: { default: 0 }
        },
        tick: function(t) {
            const d = this.data;
            const angle = (t / 1000) * d.speed + d.phase;
            const tiltRad = THREE.MathUtils.degToRad(d.tilt);
            this.el.object3D.position.x = Math.cos(angle) * d.radius;
            this.el.object3D.position.z = Math.sin(angle) * d.radius;
            this.el.object3D.position.y = d.yOffset + Math.sin(angle * 0.5 + tiltRad) * d.radius * 0.3;
        }
    });

    // ── Breathing scale ──
    AFRAME.registerComponent('breathe', {
        schema: { speed: { default: 0.5 }, amount: { default: 0.05 } },
        tick: function(t) {
            const s = 1 + Math.sin(t / 1000 * this.data.speed) * this.data.amount;
            this.el.object3D.scale.set(s, s, s);
        }
    });

    // ── Look at player (billboard) ──
    AFRAME.registerComponent('face-player', {
        tick: function() {
            const cam = this.el.sceneEl.camera;
            if (!cam) return;
            const pos = new THREE.Vector3();
            cam.getWorldPosition(pos);
            this.el.object3D.lookAt(pos);
        }
    });

    // ── Glitch on raycaster hover ──
    AFRAME.registerComponent('glitch-target', {
        schema: { intensity: { default: 1 } },
        init: function() {
            this.originalPos = this.el.object3D.position.clone();
            this.glitching = false;
            this.glitchTimer = 0;

            this.el.addEventListener('raycaster-intersected', () => {
                this.glitching = true;
                this.glitchTimer = 0;
                this.el.sceneEl.systems.corruption.add(0.01);
                playGlitchSound(100 + Math.random() * 800, 0.15, 'sawtooth');
            });
            this.el.addEventListener('raycaster-intersected-cleared', () => {
                this.glitching = false;
                this.el.object3D.position.copy(this.originalPos);
            });
        },
        tick: function(t, dt) {
            if (!this.glitching) return;
            this.glitchTimer += dt;
            const i = this.data.intensity;
            if (Math.random() > 0.7) {
                this.el.object3D.position.x = this.originalPos.x + (Math.random() - 0.5) * 0.1 * i;
                this.el.object3D.position.y = this.originalPos.y + (Math.random() - 0.5) * 0.1 * i;
            }
            if (Math.random() > 0.9) {
                const mesh = this.el.getObject3D('mesh');
                if (mesh && mesh.material) {
                    mesh.material.color.setHSL(Math.random(), 1, 0.5);
                    setTimeout(() => {
                        if (mesh.material) mesh.material.color.set('#ffffff');
                    }, 100);
                }
            }
        }
    });

    // ── Portal teleporter ──
    AFRAME.registerComponent('portal', {
        schema: {
            target: { type: 'vec3', default: { x: 0, y: 0, z: 0 } },
            color: { default: '#f5576c' }
        },
        init: function() {
            this.el.addEventListener('click', () => {
                const rig = document.getElementById('rig');
                if (rig) {
                    rig.object3D.position.set(
                        this.data.target.x,
                        this.data.target.y,
                        this.data.target.z
                    );
                    playGlitchSound(80, 0.8, 'sawtooth');
                    playGlitchSound(1200, 0.4, 'square');

                    // Flash effect
                    const flash = document.getElementById('flash-sphere');
                    if (flash) {
                        flash.object3D.visible = true;
                        setTimeout(() => { flash.object3D.visible = false; }, 300);
                    }
                }
            });
        }
    });

    // ── Ambient particles ──
    AFRAME.registerComponent('ambient-particles', {
        schema: {
            count: { default: 60 },
            color: { default: '#f5576c' },
            spread: { default: 20 },
            size: { default: 0.03 }
        },
        init: function() {
            const geo = new THREE.BufferGeometry();
            const positions = new Float32Array(this.data.count * 3);
            const velocities = [];
            for (let i = 0; i < this.data.count; i++) {
                positions[i * 3] = (Math.random() - 0.5) * this.data.spread;
                positions[i * 3 + 1] = Math.random() * this.data.spread * 0.5;
                positions[i * 3 + 2] = (Math.random() - 0.5) * this.data.spread;
                velocities.push({
                    x: (Math.random() - 0.5) * 0.002,
                    y: (Math.random() - 0.5) * 0.001,
                    z: (Math.random() - 0.5) * 0.002
                });
            }
            geo.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            const mat = new THREE.PointsMaterial({
                color: this.data.color,
                size: this.data.size,
                transparent: true,
                opacity: 0.6,
                blending: THREE.AdditiveBlending,
                depthWrite: false
            });
            this.points = new THREE.Points(geo, mat);
            this.el.object3D.add(this.points);
            this.velocities = velocities;
        },
        tick: function() {
            const pos = this.points.geometry.attributes.position;
            const spread = this.data.spread;
            for (let i = 0; i < this.data.count; i++) {
                pos.array[i * 3] += this.velocities[i].x;
                pos.array[i * 3 + 1] += this.velocities[i].y;
                pos.array[i * 3 + 2] += this.velocities[i].z;
                // Wrap
                if (Math.abs(pos.array[i * 3]) > spread / 2) this.velocities[i].x *= -1;
                if (pos.array[i * 3 + 1] > spread * 0.5 || pos.array[i * 3 + 1] < 0) this.velocities[i].y *= -1;
                if (Math.abs(pos.array[i * 3 + 2]) > spread / 2) this.velocities[i].z *= -1;
            }
            pos.needsUpdate = true;
        }
    });

    // ── Corruption visual overlay (RGB shift on the world) ──
    AFRAME.registerComponent('corruption-fx', {
        init: function() {
            this.el.sceneEl.addEventListener('corruption-changed', (e) => {
                const level = e.detail.level;
                // Tint the fog
                const scene = this.el.sceneEl.object3D;
                if (scene.fog) {
                    const r = 0.0 + level * 0.3;
                    const g = 0.0;
                    const b = 0.02 + level * 0.1;
                    scene.fog.color.setRGB(r, g, b);
                }
            });
        }
    });

    // ── Scanning light beam ──
    AFRAME.registerComponent('scan-light', {
        schema: { speed: { default: 0.5 }, range: { default: 10 } },
        tick: function(t) {
            const y = (Math.sin(t / 1000 * this.data.speed) * 0.5 + 0.5) * this.data.range;
            this.el.object3D.position.y = y;
        }
    });

    // ── Glitch teleport (randomly shifts position occasionally) ──
    AFRAME.registerComponent('glitch-pos', {
        schema: { intensity: { default: 0.5 }, freq: { default: 0.02 } },
        init: function() {
            this.basePos = this.el.object3D.position.clone();
        },
        tick: function() {
            if (Math.random() < this.data.freq) {
                const i = this.data.intensity;
                this.el.object3D.position.set(
                    this.basePos.x + (Math.random() - 0.5) * i,
                    this.basePos.y + (Math.random() - 0.5) * i,
                    this.basePos.z + (Math.random() - 0.5) * i
                );
            } else if (Math.random() < 0.01) {
                this.el.object3D.position.copy(this.basePos);
            }
        }
    });

    // ── Color cycle on material ──
    AFRAME.registerComponent('color-cycle', {
        schema: { speed: { default: 0.3 } },
        tick: function(t) {
            const mesh = this.el.getObject3D('mesh');
            if (mesh && mesh.material && mesh.material.emissive) {
                const hue = (t / 1000 * this.data.speed) % 1;
                mesh.material.emissive.setHSL(hue, 0.8, 0.15);
            }
        }
    });

    // ── Portal ring visual ──
    AFRAME.registerComponent('portal-ring', {
        schema: { color: { default: '#f5576c' } },
        init: function() {
            // Create ring geometry
            const ring = document.createElement('a-torus');
            ring.setAttribute('radius', 1.2);
            ring.setAttribute('radius-tubular', 0.06);
            ring.setAttribute('segments-tubular', 32);
            ring.setAttribute('segments-radial', 12);
            ring.setAttribute('material', `color: ${this.data.color}; emissive: ${this.data.color}; emissiveIntensity: 0.8; transparent: true; opacity: 0.9`);
            ring.setAttribute('spin', 'x: 0; y: 0; z: 0.5');
            this.el.appendChild(ring);

            // Inner glow plane
            const glow = document.createElement('a-circle');
            glow.setAttribute('radius', 1.1);
            glow.setAttribute('material', `color: ${this.data.color}; transparent: true; opacity: 0.15; side: double`);
            glow.setAttribute('breathe', 'speed: 1; amount: 0.1');
            this.el.appendChild(glow);
        }
    });

    // ── Corruption orb collectible ──
    AFRAME.registerComponent('corruption-orb', {
        init: function() {
            this.el.addEventListener('click', () => {
                this.el.sceneEl.systems.corruption.add(0.08);
                playGlitchSound(600, 0.3, 'sine');
                playGlitchSound(150, 0.5, 'sawtooth');

                // Visual burst
                this.el.setAttribute('animation', 'property: scale; to: 0 0 0; dur: 300; easing: easeInBack');
                setTimeout(() => this.el.parentNode?.removeChild(this.el), 400);
            });
        }
    });

</script>


<!-- ═══════════════════════════════════════════════
     A-FRAME SCENE
     ═══════════════════════════════════════════════ -->
<a-scene
    fog="type: exponential; color: #020005; density: 0.015"
    background="color: #020005"
    renderer="antialias: true; colorManagement: true; physicallyCorrectLights: true"
    vr-mode-ui="enabled: true"
    corruption-fx>

    <!-- ── ASSETS ── -->
    <a-assets timeout="30000">
        <!-- 35mm film -->
        <img id="film01" src="art/film_01.jpg" crossorigin="anonymous">
        <img id="film02" src="art/film_02.jpg" crossorigin="anonymous">
        <img id="film03" src="art/film_03.jpg" crossorigin="anonymous">
        <img id="film04" src="art/film_04.jpg" crossorigin="anonymous">
        <img id="film05" src="art/film_05.jpg" crossorigin="anonymous">
        <!-- Scanner -->
        <img id="scan01" src="art/scan_01.jpg" crossorigin="anonymous">
        <img id="scan02" src="art/scan_02.jpg" crossorigin="anonymous">
        <img id="scan03" src="art/scan_03.jpg" crossorigin="anonymous">
        <img id="scan04" src="art/scan_04.jpg" crossorigin="anonymous">
        <!-- Glitch / original-copy -->
        <img id="glitch01" src="art/glitch_01.jpg" crossorigin="anonymous">
        <img id="glitch02" src="art/glitch_02.jpg" crossorigin="anonymous">
        <img id="glitch03" src="art/glitch_03.jpg" crossorigin="anonymous">
        <img id="glitch04" src="art/glitch_04.jpg" crossorigin="anonymous">
        <img id="glitch05" src="art/glitch_05.jpg" crossorigin="anonymous">
        <!-- Agent Chaos -->
        <img id="chaos01" src="art/chaos_01.jpg" crossorigin="anonymous">
        <img id="chaos02" src="art/chaos_02.jpg" crossorigin="anonymous">
        <img id="chaos03" src="art/chaos_03.jpg" crossorigin="anonymous">
        <!-- Street art / monster -->
        <img id="monster01" src="art/monster_01.jpg" crossorigin="anonymous">
        <!-- Roach game -->
        <img id="roach01" src="art/roach_01.jpg" crossorigin="anonymous">
        <img id="roach02" src="art/roach_02.jpg" crossorigin="anonymous">
        <!-- Anijam -->
        <img id="anim01" src="art/anim_01.jpg" crossorigin="anonymous">
        <img id="anim02" src="art/anim_02.jpg" crossorigin="anonymous">
        <!-- Other -->
        <img id="besneni01" src="art/besneni_01.png" crossorigin="anonymous">
        <img id="trees01" src="art/trees_01.jpg" crossorigin="anonymous">
        <img id="sunflower01" src="art/sunflower_01.jpg" crossorigin="anonymous">
    </a-assets>


    <!-- ═══════════════════════════════════════════
         ROOM 1: THE WHITE GALLERY (spawn point)
         Origin: 0, 0, 0
         ═══════════════════════════════════════════ -->
    <a-entity id="room-gallery" position="0 0 0">
        <!-- Floor -->
        <a-plane position="0 0 0" rotation="-90 0 0" width="16" height="16"
                 material="color: #0a0a0a; roughness: 0.9"></a-plane>

        <!-- Walls -->
        <a-box position="0 3 -8" width="16" height="6" depth="0.2"
               material="color: #111; roughness: 0.95" breathe="speed: 0.3; amount: 0.008"></a-box>
        <a-box position="0 3 8" width="16" height="6" depth="0.2"
               material="color: #111; roughness: 0.95"></a-box>
        <a-box position="-8 3 0" width="0.2" height="6" depth="16"
               material="color: #111; roughness: 0.95" breathe="speed: 0.25; amount: 0.01"></a-box>
        <a-box position="8 3 0" width="0.2" height="6" depth="16"
               material="color: #111; roughness: 0.95"></a-box>

        <!-- Ceiling with gap -->
        <a-plane position="0 6 0" rotation="90 0 0" width="16" height="16"
                 material="color: #080808; roughness: 1"></a-plane>

        <!-- Gallery lighting -->
        <a-light type="point" position="0 5 0" intensity="0.8" color="#e8dcc8" distance="15"></a-light>
        <a-light type="ambient" intensity="0.15" color="#1a1a2e"></a-light>

        <!-- 35mm photos on walls (framed) -->
        <!-- Back wall -->
        <a-entity position="-4 2.5 -7.8" glitch-target>
            <a-plane width="2.2" height="3.2" material="color: #222"></a-plane>
            <a-plane width="2" height="3" position="0 0 0.01" src="#film01"
                     material="shader: flat"></a-plane>
        </a-entity>
        <a-entity position="0 2.5 -7.8" glitch-target>
            <a-plane width="2.2" height="3.2" material="color: #222"></a-plane>
            <a-plane width="2" height="3" position="0 0 0.01" src="#film02"
                     material="shader: flat"></a-plane>
        </a-entity>
        <a-entity position="4 2.5 -7.8" glitch-target>
            <a-plane width="2.2" height="3.2" material="color: #222"></a-plane>
            <a-plane width="2" height="3" position="0 0 0.01" src="#film03"
                     material="shader: flat"></a-plane>
        </a-entity>

        <!-- Left wall -->
        <a-entity position="-7.8 2.5 -3" rotation="0 90 0" glitch-target>
            <a-plane width="2.2" height="3.2" material="color: #222"></a-plane>
            <a-plane width="2" height="3" position="0 0 0.01" src="#film04"
                     material="shader: flat"></a-plane>
        </a-entity>
        <a-entity position="-7.8 2.5 3" rotation="0 90 0" glitch-target>
            <a-plane width="2.2" height="3.2" material="color: #222"></a-plane>
            <a-plane width="2" height="3" position="0 0 0.01" src="#film05"
                     material="shader: flat"></a-plane>
        </a-entity>

        <!-- Right wall - scanner art -->
        <a-entity position="7.8 2.5 -3" rotation="0 -90 0" glitch-target>
            <a-plane width="2.2" height="3.2" material="color: #222"></a-plane>
            <a-plane width="2" height="3" position="0 0 0.01" src="#scan01"
                     material="shader: flat"></a-plane>
        </a-entity>
        <a-entity position="7.8 2.5 3" rotation="0 -90 0" glitch-target>
            <a-plane width="2.2" height="3.2" material="color: #222"></a-plane>
            <a-plane width="2" height="3" position="0 0 0.01" src="#scan02"
                     material="shader: flat"></a-plane>
        </a-entity>

        <!-- Gallery label -->
        <a-text value="35mm" position="0 4.5 -7.7" align="center" color="#333"
                font="monoid" width="8" letter-spacing="8"></a-text>

        <!-- Corruption orbs hidden in gallery -->
        <a-sphere position="7.5 0.5 7.5" radius="0.15"
                  material="color: #f5576c; emissive: #f5576c; emissiveIntensity: 0.8; transparent: true; opacity: 0.8"
                  float="amplitude: 0.1; speed: 2" corruption-orb
                  class="clickable"></a-sphere>
        <a-sphere position="-7.5 0.3 -7.5" radius="0.15"
                  material="color: #667eea; emissive: #667eea; emissiveIntensity: 0.8; transparent: true; opacity: 0.8"
                  float="amplitude: 0.15; speed: 1.5; phase: 2" corruption-orb
                  class="clickable"></a-sphere>

        <!-- Portal to Room 2 -->
        <a-entity position="0 1.5 7.5" portal-ring="color: #f5576c"
                  portal="target: 0 0 30" class="clickable">
            <a-text value=">>> FEEDBACK >>>" position="0 -1.8 0" align="center"
                    color="#f5576c" font="monoid" width="4" opacity="0.7"></a-text>
        </a-entity>

        <!-- Ambient particles -->
        <a-entity ambient-particles="count: 40; color: #e8dcc8; spread: 16; size: 0.02"></a-entity>
    </a-entity>


    <!-- ═══════════════════════════════════════════
         ROOM 2: FEEDBACK CATHEDRAL
         Origin: 0, 0, 30
         ═══════════════════════════════════════════ -->
    <a-entity id="room-feedback" position="0 0 30">
        <!-- Floor - tiled with scanner art -->
        <a-plane position="0 0 0" rotation="-90 0 0" width="12" height="24"
                 src="#scan03" material="repeat: 4 8; roughness: 0.8"></a-plane>

        <!-- Tall narrow walls (cathedral proportions) -->
        <a-box position="-6 5 0" width="0.15" height="10" depth="24"
               material="color: #1a0020; emissive: #1a0020; emissiveIntensity: 0.3"
               breathe="speed: 0.4; amount: 0.02"></a-box>
        <a-box position="6 5 0" width="0.15" height="10" depth="24"
               material="color: #1a0020; emissive: #200020; emissiveIntensity: 0.3"
               breathe="speed: 0.35; amount: 0.02"></a-box>

        <!-- Ceiling ribs -->
        <a-box position="0 10 -8" width="12" height="0.1" depth="0.5"
               material="color: #200030" spin="x: 0; y: 0; z: 0.01"></a-box>
        <a-box position="0 10 -4" width="12" height="0.1" depth="0.5"
               material="color: #200030"></a-box>
        <a-box position="0 10 0" width="12" height="0.1" depth="0.5"
               material="color: #200030" spin="x: 0; y: 0; z: -0.01"></a-box>
        <a-box position="0 10 4" width="12" height="0.1" depth="0.5"
               material="color: #200030"></a-box>
        <a-box position="0 10 8" width="12" height="0.1" depth="0.5"
               material="color: #200030" spin="x: 0; y: 0; z: 0.01"></a-box>

        <!-- Floating glitch art panels -->
        <a-plane position="-3 3 -8" rotation="0 20 5" width="3" height="3"
                 src="#glitch01" material="shader: flat; transparent: true; opacity: 0.9; side: double"
                 float="amplitude: 0.4; speed: 0.8; phase: 0"
                 glitch-target glitch-pos="intensity: 0.3; freq: 0.05" class="clickable"></a-plane>

        <a-plane position="3 5 -4" rotation="0 -15 -8" width="3" height="3"
                 src="#glitch02" material="shader: flat; transparent: true; opacity: 0.85; side: double"
                 float="amplitude: 0.5; speed: 0.6; phase: 1.5"
                 glitch-target glitch-pos="intensity: 0.4; freq: 0.04" class="clickable"></a-plane>

        <a-plane position="-2 4 0" rotation="0 30 10" width="4" height="4"
                 src="#glitch03" material="shader: flat; transparent: true; opacity: 0.95; side: double"
                 float="amplitude: 0.3; speed: 1.2; phase: 3"
                 glitch-target glitch-pos="intensity: 0.5; freq: 0.06" class="clickable"></a-plane>

        <a-plane position="4 2 4" rotation="0 -25 -5" width="2.5" height="2.5"
                 src="#glitch04" material="shader: flat; transparent: true; opacity: 0.8; side: double"
                 float="amplitude: 0.6; speed: 0.5; phase: 4.5"
                 glitch-target glitch-pos="intensity: 0.3; freq: 0.03" class="clickable"></a-plane>

        <a-plane position="-4 6 8" rotation="0 10 15" width="3.5" height="3.5"
                 src="#glitch05" material="shader: flat; transparent: true; opacity: 0.7; side: double"
                 float="amplitude: 0.5; speed: 0.7; phase: 6"
                 glitch-target glitch-pos="intensity: 0.6; freq: 0.07" class="clickable"></a-plane>

        <!-- Scanner art as wall decorations -->
        <a-plane position="-5.8 4 -6" rotation="0 90 0" width="3" height="4"
                 src="#scan04" material="shader: flat; side: double"
                 glitch-target class="clickable"></a-plane>
        <a-plane position="5.8 5 2" rotation="0 -90 0" width="3" height="4"
                 src="#scan01" material="shader: flat; side: double"
                 glitch-target class="clickable"></a-plane>

        <!-- Lighting - dramatic pink/blue -->
        <a-light type="point" position="-3 8 -5" intensity="1.5" color="#f5576c" distance="15"></a-light>
        <a-light type="point" position="3 8 5" intensity="1.5" color="#667eea" distance="15"></a-light>
        <a-light type="point" position="0 2 0" intensity="0.5" color="#43e97b" distance="8"
                 scan-light="speed: 0.3; range: 8"></a-light>

        <!-- Ambient particles - hot pink -->
        <a-entity ambient-particles="count: 80; color: #f5576c; spread: 12; size: 0.04"></a-entity>
        <a-entity ambient-particles="count: 40; color: #667eea; spread: 12; size: 0.03"></a-entity>

        <!-- Corruption orbs -->
        <a-sphere position="0 7 -6" radius="0.2"
                  material="color: #43e97b; emissive: #43e97b; emissiveIntensity: 1"
                  float="amplitude: 0.3; speed: 1" corruption-orb class="clickable"></a-sphere>

        <!-- Label -->
        <a-text value="FEEDBACK" position="0 9 -11" align="center" color="#f5576c"
                font="monoid" width="10" letter-spacing="5" opacity="0.5"></a-text>

        <!-- Portal back -->
        <a-entity position="0 1.5 -11.5" portal-ring="color: #e8dcc8"
                  portal="target: 0 0 2" class="clickable">
            <a-text value="<<< GALLERY" position="0 -1.8 0" align="center"
                    color="#e8dcc8" font="monoid" width="3" opacity="0.5"></a-text>
        </a-entity>

        <!-- Portal to Room 3 -->
        <a-entity position="0 1.5 11.5" portal-ring="color: #43e97b"
                  portal="target: 0 0 65" class="clickable">
            <a-text value=">>> CHAOS >>>" position="0 -1.8 0" align="center"
                    color="#43e97b" font="monoid" width="4" opacity="0.7"></a-text>
        </a-entity>
    </a-entity>


    <!-- ═══════════════════════════════════════════
         ROOM 3: CHAOS ARENA
         Origin: 0, 0, 65
         ═══════════════════════════════════════════ -->
    <a-entity id="room-chaos" position="0 0 65">
        <!-- No floor - floating platforms! -->
        <a-box position="0 -0.5 0" width="4" height="1" depth="4"
               material="color: #1a0a0a; emissive: #200000; emissiveIntensity: 0.2"
               breathe="speed: 0.2; amount: 0.03"></a-box>
        <a-box position="6 0 -4" width="3" height="0.5" depth="3"
               material="color: #0a1a0a; emissive: #002000; emissiveIntensity: 0.2"
               float="amplitude: 0.3; speed: 0.4; phase: 1"></a-box>
        <a-box position="-5 1 5" width="3" height="0.5" depth="3"
               material="color: #0a0a1a; emissive: #000020; emissiveIntensity: 0.2"
               float="amplitude: 0.4; speed: 0.3; phase: 3"></a-box>
        <a-box position="4 -1 8" width="2.5" height="0.5" depth="2.5"
               material="color: #1a1a0a; emissive: #202000; emissiveIntensity: 0.2"
               float="amplitude: 0.5; speed: 0.5; phase: 5"></a-box>
        <a-box position="-7 0.5 -6" width="2" height="0.5" depth="2"
               material="color: #1a0a1a; emissive: #200020; emissiveIntensity: 0.2"
               float="amplitude: 0.2; speed: 0.6; phase: 2"></a-box>

        <!-- Giant Agent Chaos billboard walls -->
        <a-plane position="0 5 -12" width="16" height="9"
                 src="#chaos01" material="shader: flat; side: double"
                 breathe="speed: 0.15; amount: 0.02"
                 glitch-target class="clickable"></a-plane>
        <a-plane position="-12 5 0" rotation="0 90 0" width="16" height="9"
                 src="#chaos02" material="shader: flat; side: double"
                 breathe="speed: 0.2; amount: 0.015"
                 glitch-target class="clickable"></a-plane>
        <a-plane position="12 5 0" rotation="0 -90 0" width="16" height="9"
                 src="#chaos03" material="shader: flat; side: double"
                 breathe="speed: 0.18; amount: 0.025"
                 glitch-target class="clickable"></a-plane>

        <!-- GIANT street art monster billboard -->
        <a-plane position="0 8 12" width="10" height="13"
                 src="#monster01" material="shader: flat; side: double; transparent: true"
                 face-player
                 breathe="speed: 0.5; amount: 0.03"
                 glitch-target class="clickable"></a-plane>

        <!-- Floating roach game art -->
        <a-plane position="5 3 -3" width="3" height="1.7"
                 src="#roach01" material="shader: flat; side: double"
                 orbit="radius: 7; speed: 0.2; phase: 0; yOffset: 3"
                 face-player glitch-pos="intensity: 0.4; freq: 0.03"
                 glitch-target class="clickable"></a-plane>
        <a-plane position="-5 4 4" width="3" height="1.7"
                 src="#roach02" material="shader: flat; side: double"
                 orbit="radius: 8; speed: -0.15; phase: 3; yOffset: 4"
                 face-player glitch-pos="intensity: 0.3; freq: 0.04"
                 glitch-target class="clickable"></a-plane>

        <!-- Anijam drawings floating as ghosts -->
        <a-plane position="3 6 5" width="2.5" height="1.8"
                 src="#anim01" material="shader: flat; side: double; transparent: true; opacity: 0.7"
                 orbit="radius: 5; speed: 0.35; phase: 1; tilt: 30; yOffset: 5"
                 face-player></a-plane>
        <a-plane position="-3 7 -3" width="2.5" height="1.8"
                 src="#anim02" material="shader: flat; side: double; transparent: true; opacity: 0.6"
                 orbit="radius: 6; speed: -0.25; phase: 4; tilt: -20; yOffset: 6"
                 face-player></a-plane>

        <!-- Besneni cover floating ominously -->
        <a-plane position="0 10 0" width="4" height="5"
                 src="#besneni01" material="shader: flat; side: double; transparent: true; opacity: 0.5"
                 spin="x: 0; y: 0.1; z: 0.05"
                 float="amplitude: 1; speed: 0.2"
                 glitch-target class="clickable"></a-plane>

        <!-- Chaos lighting -->
        <a-light type="point" position="0 8 0" intensity="1" color="#ff4444" distance="20"></a-light>
        <a-light type="point" position="-8 3 -8" intensity="0.8" color="#44ff44" distance="12"></a-light>
        <a-light type="point" position="8 3 8" intensity="0.8" color="#4444ff" distance="12"></a-light>

        <!-- Many particles -->
        <a-entity ambient-particles="count: 80; color: #ff4444; spread: 25; size: 0.05"></a-entity>
        <a-entity ambient-particles="count: 60; color: #44ff44; spread: 25; size: 0.04"></a-entity>
        <a-entity ambient-particles="count: 40; color: #4444ff; spread: 25; size: 0.03"></a-entity>

        <!-- Corruption orbs scattered on platforms -->
        <a-sphere position="6 1 -4" radius="0.18"
                  material="color: #ff4444; emissive: #ff4444; emissiveIntensity: 1"
                  float="amplitude: 0.15; speed: 2; phase: 1" corruption-orb class="clickable"></a-sphere>
        <a-sphere position="-5 2 5" radius="0.18"
                  material="color: #44ff44; emissive: #44ff44; emissiveIntensity: 1"
                  float="amplitude: 0.2; speed: 1.5; phase: 3" corruption-orb class="clickable"></a-sphere>

        <!-- CHAOS label -->
        <a-text value="C H A O S" position="0 14 0" align="center" color="#ff4444"
                font="monoid" width="20" letter-spacing="10" opacity="0.3"
                rotation="-90 0 0"></a-text>

        <!-- Portal back to Feedback -->
        <a-entity position="0 1.5 -13" portal-ring="color: #f5576c"
                  portal="target: 0 0 35" class="clickable">
            <a-text value="<<< FEEDBACK" position="0 -1.8 0" align="center"
                    color="#f5576c" font="monoid" width="3" opacity="0.5"></a-text>
        </a-entity>

        <!-- Portal to Final Room -->
        <a-entity position="0 1.5 13" portal-ring="color: #fff"
                  portal="target: 0 0 100" class="clickable">
            <a-text value=">>> ENTROPY >>>" position="0 -1.8 0" align="center"
                    color="#fff" font="monoid" width="4" opacity="0.7"></a-text>
        </a-entity>
    </a-entity>


    <!-- ═══════════════════════════════════════════
         ROOM 4: ENTROPY — THE FINAL COLLAPSE
         Origin: 0, 0, 100
         ═══════════════════════════════════════════ -->
    <a-entity id="room-entropy" position="0 0 100">
        <!-- Invisible floor for standing -->
        <a-plane position="0 -0.01 0" rotation="-90 0 0" width="6" height="6"
                 material="color: #050505; transparent: true; opacity: 0.5"></a-plane>

        <!-- ALL artwork orbiting in a galaxy vortex -->
        <!-- Inner ring - fast -->
        <a-plane width="2" height="3" src="#film01"
                 material="shader: flat; side: double; transparent: true; opacity: 0.8"
                 orbit="radius: 4; speed: 0.5; phase: 0; yOffset: 2" face-player
                 glitch-target class="clickable"></a-plane>
        <a-plane width="2" height="3" src="#film03"
                 material="shader: flat; side: double; transparent: true; opacity: 0.75"
                 orbit="radius: 4; speed: 0.5; phase: 2.1; yOffset: 3" face-player
                 glitch-target class="clickable"></a-plane>
        <a-plane width="2" height="3" src="#film05"
                 material="shader: flat; side: double; transparent: true; opacity: 0.7"
                 orbit="radius: 4; speed: 0.5; phase: 4.2; yOffset: 1.5" face-player
                 glitch-target class="clickable"></a-plane>

        <!-- Middle ring - medium -->
        <a-plane width="3" height="3" src="#glitch01"
                 material="shader: flat; side: double; transparent: true; opacity: 0.85"
                 orbit="radius: 7; speed: 0.3; phase: 0.5; tilt: 20; yOffset: 4" face-player
                 glitch-pos="intensity: 0.5; freq: 0.08"
                 glitch-target class="clickable"></a-plane>
        <a-plane width="3" height="3" src="#glitch03"
                 material="shader: flat; side: double; transparent: true; opacity: 0.8"
                 orbit="radius: 7; speed: 0.3; phase: 2.6; tilt: -15; yOffset: 2" face-player
                 glitch-pos="intensity: 0.6; freq: 0.06"
                 glitch-target class="clickable"></a-plane>
        <a-plane width="3" height="3" src="#glitch05"
                 material="shader: flat; side: double; transparent: true; opacity: 0.75"
                 orbit="radius: 7; speed: 0.3; phase: 4.7; tilt: 10; yOffset: 5" face-player
                 glitch-pos="intensity: 0.4; freq: 0.07"
                 glitch-target class="clickable"></a-plane>

        <!-- Outer ring - slow -->
        <a-plane width="5" height="2.8" src="#chaos01"
                 material="shader: flat; side: double; transparent: true; opacity: 0.6"
                 orbit="radius: 11; speed: 0.15; phase: 0; tilt: 30; yOffset: 3" face-player
                 glitch-target class="clickable"></a-plane>
        <a-plane width="5" height="2.8" src="#chaos02"
                 material="shader: flat; side: double; transparent: true; opacity: 0.55"
                 orbit="radius: 11; speed: 0.15; phase: 2; tilt: -25; yOffset: 6" face-player
                 glitch-target class="clickable"></a-plane>
        <a-plane width="5" height="2.8" src="#chaos03"
                 material="shader: flat; side: double; transparent: true; opacity: 0.5"
                 orbit="radius: 11; speed: 0.15; phase: 4; tilt: 15; yOffset: 1" face-player
                 glitch-target class="clickable"></a-plane>

        <!-- Scattered extra pieces -->
        <a-plane width="2.5" height="1.5" src="#roach01"
                 material="shader: flat; side: double; transparent: true; opacity: 0.7"
                 orbit="radius: 9; speed: -0.2; phase: 1; tilt: 45; yOffset: 7" face-player
                 glitch-pos="intensity: 0.8; freq: 0.1"></a-plane>
        <a-plane width="3" height="4" src="#monster01"
                 material="shader: flat; side: double; transparent: true; opacity: 0.6"
                 orbit="radius: 13; speed: -0.1; phase: 3; tilt: -10; yOffset: 5" face-player
                 breathe="speed: 0.8; amount: 0.05"></a-plane>
        <a-plane width="3" height="4" src="#trees01"
                 material="shader: flat; side: double; transparent: true; opacity: 0.5"
                 orbit="radius: 14; speed: 0.08; phase: 5; tilt: 35; yOffset: 2" face-player></a-plane>
        <a-plane width="2.5" height="2.5" src="#sunflower01"
                 material="shader: flat; side: double; transparent: true; opacity: 0.55"
                 orbit="radius: 10; speed: -0.12; phase: 0.8; tilt: -40; yOffset: 8" face-player></a-plane>
        <a-plane width="3" height="2" src="#scan01"
                 material="shader: flat; side: double; transparent: true; opacity: 0.65"
                 orbit="radius: 8; speed: 0.25; phase: 1.5; tilt: 25; yOffset: 0.5" face-player
                 glitch-pos="intensity: 0.4; freq: 0.05"></a-plane>
        <a-plane width="3" height="2" src="#scan02"
                 material="shader: flat; side: double; transparent: true; opacity: 0.6"
                 orbit="radius: 12; speed: -0.18; phase: 3.5; tilt: -30; yOffset: 4.5" face-player></a-plane>
        <a-plane width="2.5" height="1.8" src="#anim01"
                 material="shader: flat; side: double; transparent: true; opacity: 0.5"
                 orbit="radius: 6; speed: 0.4; phase: 2.3; tilt: 50; yOffset: 6" face-player
                 glitch-pos="intensity: 0.7; freq: 0.09"></a-plane>
        <a-plane width="2.5" height="1.8" src="#anim02"
                 material="shader: flat; side: double; transparent: true; opacity: 0.45"
                 orbit="radius: 15; speed: 0.06; phase: 4.8; tilt: -55; yOffset: 9" face-player></a-plane>
        <a-plane width="3" height="3.8" src="#besneni01"
                 material="shader: flat; side: double; transparent: true; opacity: 0.5"
                 orbit="radius: 9; speed: -0.22; phase: 5.5; tilt: 20; yOffset: 3.5" face-player
                 spin="x: 0; y: 0; z: 0.02"></a-plane>

        <!-- Central light pillar -->
        <a-cylinder position="0 5 0" radius="0.05" height="15"
                    material="color: #fff; emissive: #fff; emissiveIntensity: 2; transparent: true; opacity: 0.3"
                    breathe="speed: 1; amount: 0.3"></a-cylinder>

        <!-- Entropy lighting -->
        <a-light type="point" position="0 5 0" intensity="2" color="#ffffff" distance="20"
                 animation="property: light.color; from: #f5576c; to: #667eea; dur: 4000; dir: alternate; loop: true"></a-light>
        <a-light type="point" position="0 10 0" intensity="1" color="#43e97b" distance="25"
                 animation="property: light.intensity; from: 0.5; to: 1.5; dur: 3000; dir: alternate; loop: true"></a-light>

        <!-- MASSIVE particle field -->
        <a-entity ambient-particles="count: 100; color: #f5576c; spread: 30; size: 0.04"></a-entity>
        <a-entity ambient-particles="count: 80; color: #667eea; spread: 30; size: 0.03"></a-entity>
        <a-entity ambient-particles="count: 60; color: #43e97b; spread: 30; size: 0.05"></a-entity>
        <a-entity ambient-particles="count: 40; color: #ffffff; spread: 30; size: 0.02"></a-entity>

        <!-- Final corruption orb - the big one -->
        <a-sphere position="0 5 0" radius="0.4"
                  material="color: #fff; emissive: #fff; emissiveIntensity: 2; transparent: true; opacity: 0.6"
                  float="amplitude: 0.5; speed: 0.8"
                  animation="property: material.emissive; from: #f5576c; to: #43e97b; dur: 2000; dir: alternate; loop: true"
                  corruption-orb class="clickable"></a-sphere>

        <!-- ENTROPY label in the void above -->
        <a-text value="E N T R O P Y" position="0 15 0" align="center" color="#fff"
                font="monoid" width="25" letter-spacing="12" opacity="0.15"
                rotation="-90 0 0"
                spin="x: 0; y: 0.02; z: 0"></a-text>

        <!-- Portal back to Chaos -->
        <a-entity position="0 1.5 -5" portal-ring="color: #ff4444"
                  portal="target: 0 0 70" class="clickable">
            <a-text value="<<< CHAOS" position="0 -1.8 0" align="center"
                    color="#ff4444" font="monoid" width="3" opacity="0.5"></a-text>
        </a-entity>

        <!-- Portal back to Gallery (full loop) -->
        <a-entity position="0 1.5 5" portal-ring="color: #e8dcc8"
                  portal="target: 0 0 2" class="clickable">
            <a-text value=">>> RESTART >>>" position="0 -1.8 0" align="center"
                    color="#e8dcc8" font="monoid" width="4" opacity="0.7"></a-text>
        </a-entity>
    </a-entity>


    <!-- ═══════════════════════════════════════════
         FLASH EFFECT SPHERE (hidden by default)
         ═══════════════════════════════════════════ -->
    <a-sphere id="flash-sphere" radius="0.5" position="0 1.6 0"
              material="color: #fff; shader: flat; transparent: true; opacity: 0.9; side: double"
              visible="false"></a-sphere>


    <!-- ═══════════════════════════════════════════
         CAMERA RIG
         ═══════════════════════════════════════════ -->
    <a-entity id="rig" position="0 0 2" quest-locomotion="speed: 3; snapAngle: 45">
        <a-camera
            look-controls="pointerLockEnabled: false"
            wasd-controls="enabled: true"
            position="0 1.6 0">
        </a-camera>

        <!-- Left controller - movement -->
        <a-entity id="left-ctrl"
            laser-controls="hand: left; model: true"
            raycaster="objects: .clickable; far: 20; lineColor: #f5576c; lineOpacity: 0.5">
        </a-entity>

        <!-- Right controller - interaction -->
        <a-entity id="right-ctrl"
            laser-controls="hand: right; model: true"
            raycaster="objects: .clickable; far: 20; lineColor: #667eea; lineOpacity: 0.5">
        </a-entity>
    </a-entity>

</a-scene>

<script>
    // Start ambient drone when entering VR
    document.querySelector('a-scene').addEventListener('enter-vr', () => {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        playDrone(55);
        playDrone(82.5);
    });
</script>

</body>
</html>
